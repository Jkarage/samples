# This is the config file from the Quickstart tutuorial at https://docs.withampersand.com/docs/quickstart.

specVersion: 1.1.0

integrations:

# Integration 1
 - name: readContactsAndLeads
   displayName: Read Contacts and Leads
   provider: salesforce
   read: 
    objects:              
      - objectName: contact
        schedule: every 12 hours
        destination: contactTable
        # Always read these fields
        requiredFields:
          - fieldName: firstName
          - fieldName: lastName
          - fieldName: email
        # Customer can decide during set-up if they want us to read these fields
        optionalFields:
          - fieldName: salutation
      - objectName: leads
        schedule: every 6 hours
        destination: leadsTable
        requiredFields:
          - fieldName: firstName
          - fieldName: lastName
          - fieldName: email
          - fieldName: isConverted
          - mapToName: leadSource
            mapToDisplayName: Lead Source
            prompt: Which field should we read from?
        # All other fields are optional
        optionalFieldsAuto: all

# Integration 2
 - name: createLeads
   displayName: Create Leads
   provider: salesforce
   write:
    # These are objects which are the same across all customers
    objects:
      - objectName: lead
        mode: insert
      - objectName: contact
        mode: upsert
      - objectName: tactics_c
        createOnInstall: true
        schema: $ref: something

    # These are objects which are different across customers
    mappedObjects:
      - mapToName: objectWithNote
        mapToDisplayName: Object with Note Field
        prompt: Which object should we write to to add new notes?
        mode: update
        requiredFields:
          - mapToName: noteField
            mapToDisplayName: Note Field
            prompt: Which field should we write to?

# Integration 3
 - name: watchLeadConversion
   displayName: Watch Lead Conversions
   provider: salesforce
   subscribe:
      objects:
        - objectName: lead
          destination: leadConvertedWebhook          
          event: update
          # We watch for changes on these fields
          watchFields:
            - fieldName: isConverted
          # We also want the values of these fields to be sent to our webhook.
          additionalFields:
            - fieldName: firstName
            - fieldName: lastName
            - fieldName: email
